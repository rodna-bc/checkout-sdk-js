{"version":3,"sources":["webpack://checkoutKit/webpack/bootstrap","webpack://checkoutKit/external \"tslib\"","webpack://checkoutKit/./src/embedded-checkout/errors/not-embeddable-error.ts","webpack://checkoutKit/./src/common/storage/browser-storage.ts","webpack://checkoutKit/./src/embedded-checkout/errors/invalid-login-token-error.ts","webpack://checkoutKit/./src/embedded-checkout/embedded-checkout.ts","webpack://checkoutKit/./src/embedded-checkout/loading-indicator.ts","webpack://checkoutKit/./src/embedded-checkout/resizable-iframe-creator.ts","webpack://checkoutKit/./src/embedded-checkout/embed-checkout.ts","webpack://checkoutKit/./src/common/error/errors/standard-error.ts","webpack://checkoutKit/./src/common/utility/set-prototype-of.ts","webpack://checkoutKit/./src/bundles/embedded-checkout.ts","webpack://checkoutKit/./src/embedded-checkout/embedded-checkout-events.ts","webpack://checkoutKit/./src/common/error/errors/request-error.ts","webpack://checkoutKit/external \"@bigcommerce/request-sender\"","webpack://checkoutKit/./src/common/error/errors/invalid-argument-error.ts","webpack://checkoutKit/./src/embedded-checkout/is-iframe-event.ts","webpack://checkoutKit/external \"local-storage-fallback\"","webpack://checkoutKit/./src/embedded-checkout/iframe-event-poster.ts","webpack://checkoutKit/./src/embedded-checkout/iframe-content/embedded-content-events.ts","webpack://checkoutKit/./src/embedded-checkout/iframe-event-listener.ts","webpack://checkoutKit/external \"iframe-resizer\"","webpack://checkoutKit/./src/common/url/parse-url.ts","webpack://checkoutKit/./src/common/utility/bind-decorator.ts"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","require","NotEmbeddableErrorType","BrowserStorage","_namespace","this","getItem","rawValue","external_local_storage_fallback_default","a","withNamespace","JSON","parse","error","removeItem","getItemOnce","setItem","stringify","_super","InvalidLoginTokenError","response","_this","message","body","title","type","external_tslib_","NotEmbeddableError","subtype","UnknownError","standard_error","embedded_checkout","EmbeddedCheckout","_iframeCreator","_messageListener","_messagePoster","_loadingIndicator","_requestSender","_storage","_location","_options","_isAttached","onComplete","addListener","embedded_checkout_events","CheckoutComplete","onError","CheckoutError","onLoad","CheckoutLoaded","onFrameLoad","FrameLoaded","onSignOut","SignedOut","_configureStyles","attach","Promise","resolve","listen","show","containerId","_allowCookie","then","_attemptLogin","url","createFrame","iframe","_iframe","hide","catch","_retryAllowCookie","trigger","FrameError","payload","detach","stopListen","parentNode","removeChild","iFrameResizer","close","contentWindow","styles","setTarget","post","embedded_content_events","StyleConfigured","test","parse_url","pathname","_a","redirectUrl","reject","invalid_login_token_error","origin","encodeURIComponent","href","document","style","visibility","replace","not_embeddable_error","MissingContent","bind_decorator","DEFAULT_STYLES","size","color","backgroundColor","ROTATION_ANIMATION","LoadingIndicator","options","_styles","_defineAnimation","_container","_buildContainer","_indicator","_buildIndicator","appendChild","parentId","parent_1","getElementById","Error","opacity","handleTransitionEnd","removeEventListener","addEventListener","container","createElement","display","bottom","left","height","width","position","right","top","transition","indicator","borderRadius","border","borderColor","margin","transform","transformStyle","animation","id","head","sheet","CSSStyleSheet","insertRule","ResizableIframeCreator","src","timeout","MissingContainer","allowPaymentRequest","_toResizableFrame","timeoutInterval","window","setTimeout","handleMessage","event","is_iframe_event","data","teardown","contentId","iframes","external_iframe_resizer_","scrolling","sizeWidth","heightCalculationMethod","length","clearTimeout","__webpack_exports__","embedCheckout","STORAGE_PREFIX","resizable_iframe_creator","iframe_event_listener","iframe_event_poster","loading_indicator","loadingIndicator","request_sender_","browser_storage","location","standard_error_StandardError","StandardError","_newTarget","setPrototypeOf","__proto__","captureStackTrace","stack","_embedded_checkout__WEBPACK_IMPORTED_MODULE_0__","EmbeddedCheckoutEventType","DEFAULT_RESPONSE","headers","status","RequestError","_b","errors","_c","tslib__WEBPACK_IMPORTED_MODULE_0__","_standard_error__WEBPACK_IMPORTED_MODULE_1__","InvalidArgumentError","isIframeEvent","_common_url__WEBPACK_IMPORTED_MODULE_0__","IframeEventPoster","targetOrigin","_targetWindow","_targetOrigin","postMessage","EmbeddedContentEventType","IframeEventListener","sourceOrigin","_sourceOrigin","_common_url__WEBPACK_IMPORTED_MODULE_1__","_isListening","_listeners","_handleMessage","listener","listeners","push","removeListener","index","indexOf","splice","forEach","_is_iframe_event__WEBPACK_IMPORTED_MODULE_3__","_common_utility__WEBPACK_IMPORTED_MODULE_2__","parseUrl","_error_errors__WEBPACK_IMPORTED_MODULE_0__","anchor","hash","hostname","port","protocol","search","bindDecorator","target","descriptor","bindMethodDecorator","decoratedTarget","class_1","getOwnPropertyNames","getOwnPropertyDescriptor","bindClassDecorator","method","boundMethod","set"],"mappings":"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","file":"embedded-checkout.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 142);\n","module.exports = require(\"tslib\");","import { StandardError } from '../../common/error/errors';\n\nexport enum NotEmbeddableErrorType {\n    MissingContainer = 'missing_container',\n    MissingContent = 'missing_content',\n    UnknownError = 'unknown_error',\n}\n\nexport default class NotEmbeddableError extends StandardError {\n    constructor(\n        message?: string,\n        public subtype: NotEmbeddableErrorType = NotEmbeddableErrorType.UnknownError\n    ) {\n        super(message || 'Unable to embed the checkout form.');\n\n        this.name = 'NotEmbeddableError';\n        this.type = 'not_embeddable';\n    }\n}\n","import { default as storage } from 'local-storage-fallback';\n\nexport default class BrowserStorage {\n    constructor(\n        private _namespace: string\n    ) {}\n\n    getItem<TValue = any>(key: string): TValue | null {\n        const rawValue = storage.getItem(this.withNamespace(key));\n\n        if (rawValue === null) {\n            return null;\n        }\n\n        try {\n            return JSON.parse(rawValue);\n        } catch (error) {\n            // Clean up invalid values\n            this.removeItem(this.withNamespace(key));\n\n            return null;\n        }\n    }\n\n    getItemOnce<TValue = any>(key: string): TValue | null {\n        const value = this.getItem(key);\n\n        this.removeItem(key);\n\n        return value;\n    }\n\n    setItem<TValue = any>(key: string, value: TValue): void {\n        return storage.setItem(this.withNamespace(key), JSON.stringify(value));\n    }\n\n    removeItem(key: string): void {\n        return storage.removeItem(this.withNamespace(key));\n    }\n\n    private withNamespace(key: string): string {\n        return `${this._namespace}.${key}`;\n    }\n}\n","import { Response } from '@bigcommerce/request-sender';\n\nimport { InternalErrorResponseBody } from '../../common/error';\nimport { RequestError } from '../../common/error/errors';\n\nexport default class InvalidLoginTokenError extends RequestError {\n    constructor(response: Response<InternalErrorResponseBody>) {\n        super(response, { message: response.body.title });\n\n        this.name = 'InvalidLoginTokenError';\n        this.type = 'invalid_login_token';\n    }\n}\n","import { RequestSender } from '@bigcommerce/request-sender';\nimport { IFrameComponent } from 'iframe-resizer';\n\nimport { BrowserStorage } from '../common/storage';\nimport { parseUrl } from '../common/url';\nimport { bindDecorator as bind } from '../common/utility';\n\nimport EmbeddedCheckoutError from './embedded-checkout-error';\nimport { EmbeddedCheckoutEventMap, EmbeddedCheckoutEventType } from './embedded-checkout-events';\nimport EmbeddedCheckoutOptions from './embedded-checkout-options';\nimport { InvalidLoginTokenError, NotEmbeddableError, NotEmbeddableErrorType } from './errors';\nimport { EmbeddedContentEvent, EmbeddedContentEventType } from './iframe-content/embedded-content-events';\nimport IframeEventListener from './iframe-event-listener';\nimport IframeEventPoster from './iframe-event-poster';\nimport LoadingIndicator from './loading-indicator';\nimport ResizableIframeCreator from './resizable-iframe-creator';\n\nconst CAN_RETRY_ALLOW_COOKIE = 'canRetryAllowCookie';\nconst IS_COOKIE_ALLOWED_KEY = 'isCookieAllowed';\n\n@bind\nexport default class EmbeddedCheckout {\n    private _iframe?: IFrameComponent;\n    private _isAttached: boolean;\n\n    /**\n     * @internal\n     */\n    constructor(\n        private _iframeCreator: ResizableIframeCreator,\n        private _messageListener: IframeEventListener<EmbeddedCheckoutEventMap>,\n        private _messagePoster: IframeEventPoster<EmbeddedContentEvent>,\n        private _loadingIndicator: LoadingIndicator,\n        private _requestSender: RequestSender,\n        private _storage: BrowserStorage,\n        private _location: Location,\n        private _options: EmbeddedCheckoutOptions\n    ) {\n        this._isAttached = false;\n\n        if (this._options.onComplete) {\n            this._messageListener.addListener(EmbeddedCheckoutEventType.CheckoutComplete, this._options.onComplete);\n        }\n\n        if (this._options.onError) {\n            this._messageListener.addListener(EmbeddedCheckoutEventType.CheckoutError, this._options.onError);\n        }\n\n        if (this._options.onLoad) {\n            this._messageListener.addListener(EmbeddedCheckoutEventType.CheckoutLoaded, this._options.onLoad);\n        }\n\n        if (this._options.onFrameLoad) {\n            this._messageListener.addListener(EmbeddedCheckoutEventType.FrameLoaded, this._options.onFrameLoad);\n        }\n\n        if (this._options.onSignOut) {\n            this._messageListener.addListener(EmbeddedCheckoutEventType.SignedOut, this._options.onSignOut);\n        }\n\n        this._messageListener.addListener(EmbeddedCheckoutEventType.FrameLoaded, () => this._configureStyles());\n    }\n\n    attach(): Promise<this> {\n        if (this._isAttached) {\n            return Promise.resolve(this);\n        }\n\n        this._isAttached = true;\n        this._messageListener.listen();\n        this._loadingIndicator.show(this._options.containerId);\n\n        return this._allowCookie()\n            .then(() => this._attemptLogin())\n            .then(url => this._iframeCreator.createFrame(url, this._options.containerId))\n            .then(iframe => {\n                this._iframe = iframe;\n\n                this._configureStyles();\n                this._loadingIndicator.hide();\n            })\n            .catch(error => {\n                this._isAttached = false;\n\n                return this._retryAllowCookie(error)\n                    .catch(() => {\n                        this._messageListener.trigger({\n                            type: EmbeddedCheckoutEventType.FrameError,\n                            payload: error,\n                        });\n\n                        this._loadingIndicator.hide();\n\n                        throw error;\n                    });\n            })\n            .then(() => this);\n    }\n\n    detach(): void {\n        if (!this._isAttached) {\n            return;\n        }\n\n        this._isAttached = false;\n        this._messageListener.stopListen();\n\n        if (this._iframe && this._iframe.parentNode) {\n            this._iframe.parentNode.removeChild(this._iframe);\n            this._iframe.iFrameResizer.close();\n        }\n    }\n\n    private _configureStyles(): void {\n        if (!this._iframe || !this._iframe.contentWindow || !this._options.styles) {\n            return;\n        }\n\n        this._messagePoster.setTarget(this._iframe.contentWindow);\n\n        this._messagePoster.post({\n            type: EmbeddedContentEventType.StyleConfigured,\n            payload: this._options.styles,\n        });\n    }\n\n    private _attemptLogin(): Promise<string> {\n        if (!/^\\/login\\/token/.test(parseUrl(this._options.url).pathname)) {\n            return Promise.resolve(this._options.url);\n        }\n\n        return this._requestSender.post(this._options.url)\n            .then(({ body: { redirectUrl } }) => redirectUrl)\n            .catch(response => Promise.reject(new InvalidLoginTokenError(response)));\n    }\n\n    /**\n     * This workaround is required for certain browsers (namely Safari) that\n     * prevent session cookies to be set for a third party website unless the\n     * user has recently visited such website. Therefore, before we attempt to\n     * login or set an active cart in the session, we need to first redirect the\n     * user to the domain of Embedded Checkout.\n     */\n    private _allowCookie(): Promise<void> {\n        if (this._storage.getItem(IS_COOKIE_ALLOWED_KEY)) {\n            // It could be possible that the flag is set to true but the browser\n            // has already removed the permission to store cookie. In that case,\n            // we should try to redirect the user again.\n            this._storage.setItem(CAN_RETRY_ALLOW_COOKIE, true);\n\n            return Promise.resolve();\n        }\n\n        this._storage.removeItem(CAN_RETRY_ALLOW_COOKIE);\n        this._storage.setItem(IS_COOKIE_ALLOWED_KEY, true);\n\n        const { origin } = parseUrl(this._options.url);\n        const redirectUrl = `${origin}/embedded-checkout/allow-cookie?returnUrl=${encodeURIComponent(this._location.href)}`;\n\n        document.body.style.visibility = 'hidden';\n        this._location.replace(redirectUrl);\n\n        return new Promise<never>(() => {});\n    }\n\n    private _retryAllowCookie(error: EmbeddedCheckoutError): Promise<void> {\n        const canRetry = (\n            this._storage.getItem(CAN_RETRY_ALLOW_COOKIE) &&\n            error instanceof NotEmbeddableError &&\n            error.subtype === NotEmbeddableErrorType.MissingContent\n        );\n\n        if (!canRetry) {\n            return Promise.reject();\n        }\n\n        this._storage.removeItem(CAN_RETRY_ALLOW_COOKIE);\n        this._storage.removeItem(IS_COOKIE_ALLOWED_KEY);\n\n        return this._allowCookie();\n    }\n}\n","import { LoadingIndicatorStyles } from './embedded-checkout-styles';\n\nconst DEFAULT_STYLES: LoadingIndicatorStyles = {\n    size: 70,\n    color: '#d9d9d9',\n    backgroundColor: '#ffffff',\n};\n\nconst ROTATION_ANIMATION = 'embedded-checkout-loading-indicator-rotation';\n\nexport default class LoadingIndicator {\n    private _container: HTMLElement;\n    private _indicator: HTMLElement;\n    private _styles: LoadingIndicatorStyles;\n\n    constructor(\n        options?: { styles?: LoadingIndicatorStyles }\n    ) {\n        this._styles = { ...DEFAULT_STYLES, ...options && options.styles };\n\n        this._defineAnimation();\n\n        this._container = this._buildContainer();\n        this._indicator = this._buildIndicator();\n\n        this._container.appendChild(this._indicator);\n    }\n\n    show(parentId?: string): void {\n        if (parentId) {\n            const parent = document.getElementById(parentId);\n\n            if (!parent) {\n                throw new Error('Unable to attach the loading indicator because the parent ID is not valid.');\n            }\n\n            parent.appendChild(this._container);\n        }\n\n        this._container.style.visibility = 'visible';\n        this._container.style.opacity = '1';\n    }\n\n    hide(): void {\n        const handleTransitionEnd = () => {\n            this._container.style.visibility = 'hidden';\n\n            this._container.removeEventListener('transitionend', handleTransitionEnd);\n        };\n\n        this._container.addEventListener('transitionend', handleTransitionEnd);\n\n        this._container.style.opacity = '0';\n    }\n\n    private _buildContainer(): HTMLElement {\n        const container = document.createElement('div');\n\n        container.style.display = 'block';\n        container.style.bottom = '0';\n        container.style.left = '0';\n        container.style.height = '100%';\n        container.style.width = '100%';\n        container.style.position = 'absolute';\n        container.style.right = '0';\n        container.style.top = '0';\n        container.style.transition = 'all 250ms ease-out';\n        container.style.opacity = '0';\n\n        return container;\n    }\n\n    private _buildIndicator(): HTMLElement {\n        const indicator = document.createElement('div');\n\n        indicator.style.display = 'block';\n        indicator.style.width = `${this._styles.size}px`;\n        indicator.style.height = `${this._styles.size}px`;\n        indicator.style.borderRadius = `${this._styles.size}px`;\n        indicator.style.border = 'solid 1px';\n        indicator.style.borderColor = `${this._styles.backgroundColor} ${this._styles.backgroundColor} ${this._styles.color} ${this._styles.color}`;\n        indicator.style.margin = '0 auto';\n        indicator.style.position = 'absolute';\n        indicator.style.left = '0';\n        indicator.style.right = '0';\n        indicator.style.top = '50%';\n        indicator.style.transform = 'translateY(-50%) rotate(0deg)';\n        indicator.style.transformStyle = 'preserve-3d';\n        indicator.style.animation = `${ROTATION_ANIMATION} 500ms infinite cubic-bezier(0.69, 0.31, 0.56, 0.83)`;\n\n        return indicator;\n    }\n\n    private _defineAnimation(): void {\n        // In order to define CSS animation, we need to insert a stylesheet into the host frame.\n        // We only have to do it once.\n        if (document.getElementById(ROTATION_ANIMATION)) {\n            return;\n        }\n\n        const style = document.createElement('style');\n\n        style.id = ROTATION_ANIMATION;\n\n        document.head.appendChild(style);\n\n        if (style.sheet instanceof CSSStyleSheet) {\n            style.sheet.insertRule(`\n                @keyframes ${ROTATION_ANIMATION} {\n                    0% { transform: translateY(-50%) rotate(0deg); }\n                    100% { transform: translateY(-50%) rotate(360deg); }\n                }\n            `);\n        }\n    }\n}\n","import { iframeResizer, IFrameComponent } from 'iframe-resizer';\n\nimport { parseUrl } from '../common/url';\n\nimport { EmbeddedCheckoutEventType } from './embedded-checkout-events';\nimport { NotEmbeddableError, NotEmbeddableErrorType } from './errors';\nimport isIframeEvent from './is-iframe-event';\n\nexport default class ResizableIframeCreator {\n    constructor(\n        private _options?: { timeout: number }\n    ) {}\n\n    createFrame(src: string, containerId: string): Promise<IFrameComponent> {\n        const container = document.getElementById(containerId);\n        const { timeout = 60000 } = this._options || {};\n\n        if (!container) {\n            throw new NotEmbeddableError(\n                'Unable to embed the iframe because the container element could not be found.',\n                NotEmbeddableErrorType.MissingContainer\n            );\n        }\n\n        const iframe = document.createElement('iframe');\n\n        iframe.src = src;\n        iframe.style.border = 'none';\n        iframe.style.display = 'none';\n        iframe.style.width = '100%';\n        iframe.allowPaymentRequest = true;\n\n        container.appendChild(iframe);\n\n        return this._toResizableFrame(iframe, timeout)\n            .catch(error => {\n                container.removeChild(iframe);\n\n                throw error;\n            });\n    }\n\n    private _toResizableFrame(iframe: HTMLIFrameElement, timeoutInterval: number): Promise<IFrameComponent> {\n        // Can't simply listen to `load` event because it always gets triggered even if there's an error.\n        // Instead, listen to the `load` inside the iframe and let the parent frame know when it happens.\n        return new Promise((resolve, reject) => {\n            const timeout = window.setTimeout(() => {\n                reject(new NotEmbeddableError('Unable to embed the iframe because the content could not be loaded.'));\n            }, timeoutInterval);\n\n            const handleMessage = (event: MessageEvent) => {\n                if (event.origin !== parseUrl(iframe.src).origin) {\n                    return;\n                }\n\n                if (isIframeEvent(event.data, EmbeddedCheckoutEventType.FrameError)) {\n                    teardown();\n                    reject(new NotEmbeddableError(event.data.payload.message, NotEmbeddableErrorType.MissingContent));\n                }\n\n                if (isIframeEvent(event.data, EmbeddedCheckoutEventType.FrameLoaded)) {\n                    iframe.style.display = '';\n\n                    const contentId = event.data.payload && event.data.payload.contentId;\n                    const iframes = iframeResizer({\n                        scrolling: false,\n                        sizeWidth: false,\n                        heightCalculationMethod: contentId ? 'taggedElement' : 'lowestElement',\n                    }, iframe);\n\n                    teardown();\n                    resolve(iframes[iframes.length - 1]);\n                }\n            };\n\n            const teardown = () => {\n                window.removeEventListener('message', handleMessage);\n                window.clearTimeout(timeout);\n            };\n\n            window.addEventListener('message', handleMessage);\n        });\n    }\n}\n","import { createRequestSender } from '@bigcommerce/request-sender';\n\nimport { BrowserStorage } from '../common/storage';\nimport { parseUrl } from '../common/url';\n\nimport EmbeddedCheckout from './embedded-checkout';\nimport { EmbeddedCheckoutEventMap } from './embedded-checkout-events';\nimport EmbeddedCheckoutOptions from './embedded-checkout-options';\nimport { EmbeddedContentEvent } from './iframe-content/embedded-content-events';\nimport IframeEventListener from './iframe-event-listener';\nimport IframeEventPoster from './iframe-event-poster';\nimport LoadingIndicator from './loading-indicator';\nimport ResizableIframeCreator from './resizable-iframe-creator';\n\nconst STORAGE_PREFIX = 'BigCommerce.EmbeddedCheckout';\n\n/**\n * Embed the checkout form in an iframe.\n *\n * @remarks\n * Once the iframe is embedded, it will automatically resize according to the\n * size of the checkout form. It will also notify the parent window when certain\n * events have occurred. i.e.: when the form is loaded and ready to be used.\n *\n * ```js\n * embedCheckout({\n *     url: 'https://checkout/url',\n *     containerId: 'container-id',\n * });\n * ```\n *\n * @param options - Options for embedding the checkout form.\n * @returns A promise that resolves to an instance of `EmbeddedCheckout`.\n */\nexport default function embedCheckout(options: EmbeddedCheckoutOptions): Promise<EmbeddedCheckout> {\n    const origin = parseUrl(options.url).origin;\n    const embeddedCheckout = new EmbeddedCheckout(\n        new ResizableIframeCreator(),\n        new IframeEventListener<EmbeddedCheckoutEventMap>(origin),\n        new IframeEventPoster<EmbeddedContentEvent>(origin),\n        new LoadingIndicator({ styles: options.styles && options.styles.loadingIndicator }),\n        createRequestSender(),\n        new BrowserStorage(STORAGE_PREFIX),\n        window.location,\n        options\n    );\n\n    return embeddedCheckout.attach();\n}\n","import { setPrototypeOf } from '../../utility';\n\nimport CustomError from './custom-error';\n\nexport default class StandardError extends Error implements CustomError {\n    type = 'standard';\n\n    constructor(message?: string) {\n        super(message || 'An unexpected error has occurred.');\n\n        setPrototypeOf(this, new.target.prototype);\n\n        if (typeof Error.captureStackTrace === 'function') {\n            Error.captureStackTrace(this, new.target);\n        } else {\n            this.stack = (new Error(this.message)).stack;\n        }\n    }\n}\n","export default function setPrototypeOf(object: any, prototype: object) {\n    if (Object.setPrototypeOf) {\n        Object.setPrototypeOf(object, prototype);\n    } else {\n        object.__proto__ = prototype;\n    }\n\n    return object;\n}\n","export { embedCheckout } from '../embedded-checkout';\n","import EmbeddedCheckoutError from './embedded-checkout-error';\nimport EmbeddedContentOptions from './iframe-content/embedded-content-options';\n\nexport enum EmbeddedCheckoutEventType {\n    CheckoutComplete = 'CHECKOUT_COMPLETE',\n    CheckoutError = 'CHECKOUT_ERROR',\n    CheckoutLoaded = 'CHECKOUT_LOADED',\n    FrameError = 'FRAME_ERROR',\n    FrameLoaded = 'FRAME_LOADED',\n    SignedOut = 'SIGNED_OUT',\n}\n\nexport interface EmbeddedCheckoutEventMap {\n    [EmbeddedCheckoutEventType.CheckoutComplete]: EmbeddedCheckoutCompleteEvent;\n    [EmbeddedCheckoutEventType.CheckoutError]: EmbeddedCheckoutErrorEvent;\n    [EmbeddedCheckoutEventType.CheckoutLoaded]: EmbeddedCheckoutLoadedEvent;\n    [EmbeddedCheckoutEventType.FrameError]: EmbeddedCheckoutFrameErrorEvent;\n    [EmbeddedCheckoutEventType.FrameLoaded]: EmbeddedCheckoutFrameLoadedEvent;\n    [EmbeddedCheckoutEventType.SignedOut]: EmbeddedCheckoutSignedOutEvent;\n}\n\nexport type EmbeddedCheckoutEvent = (\n    EmbeddedCheckoutCompleteEvent |\n    EmbeddedCheckoutErrorEvent |\n    EmbeddedCheckoutFrameErrorEvent |\n    EmbeddedCheckoutFrameLoadedEvent |\n    EmbeddedCheckoutLoadedEvent |\n    EmbeddedCheckoutSignedOutEvent\n);\n\nexport interface EmbeddedCheckoutCompleteEvent {\n    type: EmbeddedCheckoutEventType.CheckoutComplete;\n}\n\nexport interface EmbeddedCheckoutErrorEvent {\n    type: EmbeddedCheckoutEventType.CheckoutError;\n    payload: EmbeddedCheckoutError;\n}\n\nexport interface EmbeddedCheckoutLoadedEvent {\n    type: EmbeddedCheckoutEventType.CheckoutLoaded;\n}\n\nexport interface EmbeddedCheckoutFrameErrorEvent {\n    type: EmbeddedCheckoutEventType.FrameError;\n    payload: EmbeddedCheckoutError;\n}\n\nexport interface EmbeddedCheckoutFrameLoadedEvent {\n    type: EmbeddedCheckoutEventType.FrameLoaded;\n    payload?: EmbeddedContentOptions;\n}\n\nexport interface EmbeddedCheckoutSignedOutEvent {\n    type: EmbeddedCheckoutEventType.SignedOut;\n}\n","import { Response } from '@bigcommerce/request-sender';\n\nimport StandardError from './standard-error';\n\nconst DEFAULT_RESPONSE = {\n    body: {},\n    headers: {},\n    status: 0,\n};\n\nexport default class RequestError<TBody = any> extends StandardError {\n    body: TBody | {};\n    headers: { [key: string]: any };\n    errors: Array<{ code: string; message?: string }>;\n    status: number;\n\n    constructor(\n        response?: Response<TBody | {}>,\n        { message, errors }: {\n            message?: string;\n            errors?: Array<{ code: string; message?: string }>;\n        } = {}\n    ) {\n        const { body, headers, status } = response || DEFAULT_RESPONSE;\n\n        super(message || 'An unexpected error has occurred.');\n\n        this.name = 'RequestError';\n        this.type = 'request';\n        this.body = body;\n        this.headers = headers;\n        this.status = status;\n        this.errors = errors || [];\n    }\n}\n","module.exports = require(\"@bigcommerce/request-sender\");","import StandardError from './standard-error';\n\nexport default class InvalidArgumentError extends StandardError {\n    constructor(message?: string) {\n        super(message || 'Invalid arguments have been provided.');\n\n        this.name = 'InvalidArgumentError';\n        this.type = 'invalid_argument';\n    }\n}\n","import IframeEvent from './iframe-event';\n\nexport default function isIframeEvent<TEvent extends IframeEvent<TType>, TType extends string>(\n    object: any,\n    type: TType\n): object is TEvent {\n    return object.type === type;\n}\n","module.exports = require(\"local-storage-fallback\");","import { parseUrl } from '../common/url';\n\nexport default class IframeEventPoster<TEvent> {\n    private _targetOrigin: string;\n\n    constructor(\n        targetOrigin: string,\n        private _targetWindow?: Window\n    ) {\n        this._targetOrigin = targetOrigin === '*' ? '*' : parseUrl(targetOrigin).origin;\n    }\n\n    post(event: TEvent): void {\n        if (window === this._targetWindow) {\n            return;\n        }\n\n        if (!this._targetWindow) {\n            throw new Error('Unable to post message becauset target window is not set.');\n        }\n\n        this._targetWindow.postMessage(event, this._targetOrigin);\n    }\n\n    setTarget(window: Window) {\n        this._targetWindow = window;\n    }\n}\n","import EmbeddedCheckoutStyles from '../embedded-checkout-styles';\n\nexport enum EmbeddedContentEventType {\n    StyleConfigured = 'STYLE_CONFIGURED',\n}\n\nexport interface EmbeddedContentEventMap {\n    [EmbeddedContentEventType.StyleConfigured]: EmbeddedContentStyleConfiguredEvent;\n}\n\nexport type EmbeddedContentEvent = (\n    EmbeddedContentStyleConfiguredEvent\n);\n\nexport interface EmbeddedContentStyleConfiguredEvent {\n    type: EmbeddedContentEventType.StyleConfigured;\n    payload: EmbeddedCheckoutStyles;\n}\n","import { parseUrl } from '../common/url';\nimport { bindDecorator as bind } from '../common/utility';\n\nimport { IframeEventMap } from './iframe-event';\nimport isIframeEvent from './is-iframe-event';\n\nexport default class IframeEventListener<TEventMap extends IframeEventMap<keyof TEventMap>> {\n    private _isListening: boolean;\n    private _listeners: EventListeners<TEventMap>;\n    private _sourceOrigin: string;\n\n    constructor(\n        sourceOrigin: string\n    ) {\n        this._sourceOrigin = parseUrl(sourceOrigin).origin;\n        this._isListening = false;\n        this._listeners = {};\n    }\n\n    listen(): void {\n        if (this._isListening) {\n            return;\n        }\n\n        this._isListening = true;\n\n        window.addEventListener('message', this._handleMessage);\n    }\n\n    stopListen(): void {\n        if (!this._isListening) {\n            return;\n        }\n\n        this._isListening = false;\n\n        window.removeEventListener('message', this._handleMessage);\n    }\n\n    addListener<TType extends keyof TEventMap>(type: TType, listener: (event: TEventMap[TType]) => void): void {\n        let listeners = this._listeners[type];\n\n        if (!listeners) {\n            this._listeners[type] = listeners = [];\n        }\n\n        listeners.push(listener);\n    }\n\n    removeListener<TType extends keyof TEventMap>(type: TType, listener: (event: TEventMap[TType]) => void): void {\n        const listeners = this._listeners[type];\n\n        if (!listeners) {\n            return;\n        }\n\n        const index = listeners.indexOf(listener);\n\n        if (index >= 0) {\n            listeners.splice(index, 1);\n        }\n    }\n\n    trigger<TType extends keyof TEventMap>(event: TEventMap[TType]): void {\n        const listeners = this._listeners[event.type];\n\n        if (!listeners) {\n            return;\n        }\n\n        listeners.forEach(listener => listener(event));\n    }\n\n    @bind\n    private _handleMessage(event: MessageEvent): void {\n        if ((event.origin !== this._sourceOrigin) || !isIframeEvent(event.data, event.data.type)) {\n            return;\n        }\n\n        this.trigger(event.data);\n    }\n}\n\ntype EventListeners<TEventMap> = {\n    [key in keyof TEventMap]?: Array<(event: TEventMap[keyof TEventMap]) => void>;\n};\n","module.exports = require(\"iframe-resizer\");","import { InvalidArgumentError } from '../error/errors';\n\nimport Url from './url';\n\nexport default function parseUrl(url: string): Url {\n    if (!/^(https?:)?\\/\\//.test(url)) {\n        throw new InvalidArgumentError('The provided URL must be absolute.');\n    }\n\n    // new URL() is not supported in IE11, use anchor tag instead\n    const anchor = document.createElement('a');\n\n    anchor.href = url;\n\n    return {\n        hash: anchor.hash,\n        hostname: anchor.hostname,\n        href: anchor.href,\n        origin: anchor.origin,\n        pathname: anchor.pathname,\n        port: anchor.port,\n        protocol: anchor.protocol,\n        search: anchor.search,\n    };\n}\n","/**\n * Decorates a class or a method by binding all its prototype methods or itself\n * to the calling instance respectively.\n */\nexport default function bindDecorator<T extends Method>(target: object, key: string, descriptor: TypedPropertyDescriptor<T>): TypedPropertyDescriptor<T>;\nexport default function bindDecorator<T extends Constructor<object>>(target: T): T;\nexport default function bindDecorator(target: any, key?: any, descriptor?: any): any {\n    if (!key || !descriptor) {\n        return bindClassDecorator(target);\n    }\n\n    return bindMethodDecorator(target, key, descriptor);\n}\n\n/**\n * Decorates a class by binding all its prototype methods to the calling\n * instance.\n */\nexport function bindClassDecorator<T extends Constructor<object>>(target: T): T {\n    const decoratedTarget = class extends target {};\n\n    Object.getOwnPropertyNames(target.prototype)\n        .forEach(key => {\n            const descriptor = Object.getOwnPropertyDescriptor(target.prototype, key);\n\n            if (!descriptor || key === 'constructor') {\n                return;\n            }\n\n            Object.defineProperty(\n                decoratedTarget.prototype,\n                key,\n                bindMethodDecorator(target.prototype, key, descriptor)\n            );\n        });\n\n    return decoratedTarget;\n}\n\n/**\n * Decorates a method by binding it to the calling instance.\n */\nexport function bindMethodDecorator<T extends Method>(target: object, key: string, descriptor: TypedPropertyDescriptor<T>): TypedPropertyDescriptor<T> {\n    if (typeof descriptor.value !== 'function') {\n        return descriptor;\n    }\n\n    let method: T = descriptor.value;\n\n    return {\n        get() {\n            const boundMethod = method.bind(this);\n\n            Object.defineProperty(this, key, {\n                ...descriptor,\n                value: boundMethod,\n            });\n\n            return boundMethod;\n        },\n        set(value) {\n            method = value;\n        },\n    };\n}\n\nexport type Constructor<T> = new (...args: any[]) => T;\nexport type Method = (...args: any[]) => any;\n"],"sourceRoot":""}